[supervisord]
nodaemon=true
loglevel=info
user=root

[program:web]
directory=/app/estate_app
command=sh -c 'uvicorn app:app --host 0.0.0.0 --port ${PORT:-8000} --reload'
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
startsecs=5
stopwaitsecs=15

[program:celery_worker]
directory=/app/estate_app
environment=PYTHONPATH="/app"
command=celery -A celery_worker.celery_app.app worker --loglevel=INFO --pool=solo
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
startsecs=10
stopwaitsecs=60
startretries=3
exitcodes=0,2

[program:celery_beat]
directory=/app/estate_app
environment=PYTHONPATH="/app"
command=celery -A celery_worker.celery_app.app beat --loglevel=info
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
startsecs=10
stopwaitsecs=60
startretries=3
exitcodes=0,2